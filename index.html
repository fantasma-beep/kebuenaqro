<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kebuenaqro</title>
    <meta name="theme-color" content="#c2410c"/>
    <meta name="description" content="Reproductor de streaming de Kebuenaqro.">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="manifest" href="" id="manifest-link">
    <link rel="apple-touch-icon" href="https://fantasma-beep.github.io/kebuenaqro/logotipo2.png?v=3">

    <style>
        body {
            background-image: linear-gradient(rgba(15, 23, 42, 0.85), rgba(15, 23, 42, 0.98)), url('494615713_1348055410294820_9029691649736311255_n.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        input[type=range]{-webkit-appearance:none;appearance:none;background:transparent;cursor:pointer;width:100%}
        input[type=range]:focus{outline:none}
        input[type=range]::-webkit-slider-runnable-track{background-color:#9a3412;border-radius:.5rem;height:.5rem}
        input[type=range]::-moz-range-track{background-color:#9a3412;border-radius:.5rem;height:.5rem}
        input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;margin-top:-6px;background-color:#fdba74;border-radius:50%;height:1.25rem;width:1.25rem;border:2px solid #c2410c}
        input[type=range]::-moz-range-thumb{border:none;border-radius:50%;background-color:#fdba74;height:1.25rem;width:1.25rem;border:2px solid #c2410c}
        
        @keyframes scroll {
            from { transform: translateX(0); }
            to { transform: translateX(-50%); }
        }
        .animate-scroll {
            animation: scroll 60s linear infinite; 
        }

        /* --- CAMBIO: Se elimina la animación de rotación del logo --- */
        /*
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .logo-playing {
            animation: spin 15s linear infinite;
        }
        */
    </style>
</head>
<body class="bg-slate-900 text-slate-200 flex items-center justify-center min-h-screen font-sans antialiased p-4">

    <div class="w-full max-w-5xl mx-auto">
        <div class="mb-8 w-full overflow-hidden rounded-lg border border-orange-700/50 bg-black/20">
            <div id="banner-list" class="flex transition-transform duration-700 ease-in-out">
                <!-- Los banners se insertarán aquí dinámicamente -->
            </div>
        </div>

        <div class="flex flex-col md:flex-row justify-center gap-8">
            
            <!-- === REPRODUCTOR 1: KEBUENA CADEREYTA === -->
            <div class="w-full max-w-md bg-orange-700 rounded-2xl shadow-2xl overflow-hidden border border-orange-800">
                <div class="aspect-video bg-white flex items-center justify-center relative group">
                    <img id="player-logo-1" src="https://fantasma-beep.github.io/kebuenaqro/logo.png?v=2" alt="Kebuenaqro Logo Original" class="w-52 h-52 object-contain rounded-md" onerror="this.onerror=null;this.src='https://placehold.co/208x208/1e293b/f97316?text=Logo';">
                    <audio id="player-1" class="w-full h-full hidden" crossOrigin="anonymous"></audio>
                    <div id="video-overlay-1" class="absolute inset-0 bg-orange-800/80 backdrop-blur-sm flex flex-col items-center justify-center text-center p-4 transition-opacity duration-300">
                        <h2 id="loading-text-1" class="text-xl font-bold text-white">Cargando streaming...</h2>
                    </div>
                </div>
                <div class="p-4 text-center border-b border-orange-800">
                    <h3 id="track-title-1" class="font-bold text-lg truncate text-white">Kebuena Cadereyta</h3>
                    <p id="track-artist-1" class="text-sm text-orange-200">Streaming en Vivo</p>
                </div>
                <div class="p-4 space-y-4">
                    <div class="flex items-center gap-2">
                        <span id="current-time-1" class="text-xs w-14 text-center text-orange-200 tabular-nums">--:--</span>
                        <div class="w-full text-center text-xs text-orange-200 font-semibold tracking-wider">STREAMING EN VIVO</div>
                        <span id="total-time-1" class="text-xs w-14 text-center text-orange-200 tabular-nums">--:--</span>
                    </div>
                    <div class="flex items-center justify-between">
                         <div class="w-1/4 flex justify-start gap-2">
                             <a href="https://www.facebook.com/kebuenaqro/?locale=es_LA" target="_blank" rel="noopener noreferrer" class="p-2 rounded-full hover:bg-black/20 transition-colors">
                                 <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400" viewBox="0 0 24 24" fill="currentColor">
                                     <path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z"></path>
                                 </svg>
                             </a>
                             <a href="https://wa.me/524411358423" target="_blank" rel="noopener noreferrer" class="p-2 rounded-full hover:bg-black/20 transition-colors">
                                 <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-400" viewBox="0 0 24 24" fill="currentColor">
                                     <path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01s-.521.074-.792.372c-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.206 5.077 4.487.709.306 1.262.489 1.694.626.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"/>
                                 </svg>
                             </a>
                         </div>
                         <div class="flex items-center gap-4 w-1/2 justify-center">
                             <button id="play-pause-btn-1" class="p-4 bg-orange-500 rounded-full hover:bg-orange-400 active:scale-95 transition-transform disabled:opacity-50 disabled:bg-slate-600">
                                 <svg id="play-icon-1" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8.002v4.005a1 1 0 001.555.832l3.198-2.003a1 1 0 000-1.664l-3.198-2.003z" clip-rule="evenodd"/></svg>
                                 <svg id="pause-icon-1" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white hidden" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/></svg>
                             </button>
                         </div>
                         <div class="w-1/4 flex items-center justify-end gap-2">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-orange-200" viewBox="0 0 20 20" fill="currentColor"><path d="M5.071 8.238a.75.75 0 01.093-1.055l1.5-1.5A.75.75 0 017.72 6.74l-1.5 1.5a.75.75 0 01-1.054.093zm.593 4.586a.75.75 0 011.06-1.06l1.25 1.25a.75.75 0 11-1.06 1.06l-1.25-1.25zM12 8a1 1 0 100-2 1 1 0 000 2zM4 10a1 1 0 11-2 0 1 1 0 012 0zm11.13-1.13a.75.75 0 10-1.06-1.06l-1.25 1.25a.75.75 0 001.06 1.06l1.25-1.25zM12 4a1 1 0 100 2 1 1 0 000-2zm-8 6a1 1 0 100 2 1 1 0 000-2z"/></svg>
                             <input type="range" id="volume-control-1" value="100" min="0" max="100" class="w-24">
                         </div>
                    </div>
                </div>
            </div>

            <!-- === REPRODUCTOR 2: KEBUENA JALPAN === -->
            <div class="w-full max-w-md bg-orange-700 rounded-2xl shadow-2xl overflow-hidden border border-orange-800">
                <div class="aspect-video bg-white flex items-center justify-center relative group">
                    <img id="player-logo-2" src="https://fantasma-beep.github.io/kebuenaqro/logotipo2.png?v=3" alt="Kebuenaqro Logo" class="w-52 h-52 object-contain rounded-md" onerror="this.onerror=null;this.src='https://placehold.co/208x208/1e293b/f97316?text=Logo';">
                    <audio id="player-2" class="w-full h-full hidden" crossOrigin="anonymous"></audio>
                    <div id="video-overlay-2" class="absolute inset-0 bg-orange-800/80 backdrop-blur-sm flex flex-col items-center justify-center text-center p-4 transition-opacity duration-300">
                        <h2 id="loading-text-2" class="text-xl font-bold text-white">Cargando streaming...</h2>
                    </div>
                </div>
                <div class="p-4 text-center border-b border-orange-800">
                    <h3 id="track-title-2" class="font-bold text-lg truncate text-white">Kebuena Jalpan</h3>
                    <p id="track-artist-2" class="text-sm text-orange-200">Streaming en Vivo</p>
                </div>
                <div class="p-4 space-y-4">
                    <div class="flex items-center gap-2">
                        <span id="current-time-2" class="text-xs w-14 text-center text-orange-200 tabular-nums">--:--</span>
                        <div class="w-full text-center text-xs text-orange-200 font-semibold tracking-wider">STREAMING EN VIVO</div>
                        <span id="total-time-2" class="text-xs w-14 text-center text-orange-200 tabular-nums">--:--</span>
                    </div>
                    <div class="flex items-center justify-between">
                         <div class="w-1/4 flex justify-start gap-2">
                             <a href="https://www.facebook.com/kebuenaqro/?locale=es_LA" target="_blank" rel="noopener noreferrer" class="p-2 rounded-full hover:bg-black/20 transition-colors">
                                 <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400" viewBox="0 0 24 24" fill="currentColor">
                                     <path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z"></path>
                                 </svg>
                             </a>
                             <a href="https://wa.me/524411169504" target="_blank" rel="noopener noreferrer" class="p-2 rounded-full hover:bg-black/20 transition-colors">
                                 <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-400" viewBox="0 0 24 24" fill="currentColor">
                                     <path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01s-.521.074-.792.372c-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.206 5.077 4.487.709.306 1.262.489 1.694.626.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"/>
                                 </svg>
                             </a>
                         </div>
                         <div class="flex items-center gap-4 w-1/2 justify-center">
                             <button id="play-pause-btn-2" class="p-4 bg-orange-500 rounded-full hover:bg-orange-400 active:scale-95 transition-transform disabled:opacity-50 disabled:bg-slate-600">
                                 <svg id="play-icon-2" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8.002v4.005a1 1 0 001.555.832l3.198-2.003a1 1 0 000-1.664l-3.198-2.003z" clip-rule="evenodd"/></svg>
                                 <svg id="pause-icon-2" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white hidden" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/></svg>
                             </button>
                         </div>
                         <div class="w-1/4 flex items-center justify-end gap-2">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-orange-200" viewBox="0 0 20 20" fill="currentColor"><path d="M5.071 8.238a.75.75 0 01.093-1.055l1.5-1.5A.75.75 0 017.72 6.74l-1.5 1.5a.75.75 0 01-1.054.093zm.593 4.586a.75.75 0 011.06-1.06l1.25 1.25a.75.75 0 11-1.06 1.06l-1.25-1.25zM12 8a1 1 0 100-2 1 1 0 000 2zM4 10a1 1 0 11-2 0 1 1 0 012 0zm11.13-1.13a.75.75 0 10-1.06-1.06l-1.25 1.25a.75.75 0 001.06 1.06l1.25-1.25zM12 4a1 1 0 100 2 1 1 0 000-2zm-8 6a1 1 0 100 2 1 1 0 000-2z"/></svg>
                             <input type="range" id="volume-control-2" value="100" min="0" max="100" class="w-24">
                         </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="mt-8">
            <div class="bg-orange-800/80 backdrop-blur-sm rounded-lg shadow-lg overflow-hidden border border-orange-700">
                <div id="news-ticker-container" class="whitespace-nowrap">
                    <div id="news-list" class="inline-block">
                        <!-- Las noticias se insertarán aquí dinámicamente -->
                    </div>
                </div>
            </div>
            <div class="mt-6 text-center">
                <button id="install-btn" class="hidden bg-orange-600 hover:bg-orange-500 text-white font-bold py-2 px-4 rounded-lg inline-flex items-center transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>
                    <span>Instalar Aplicación</span>
                </button>
                <div id="ios-install-banner" class="hidden bg-orange-800/80 p-3 rounded-lg text-white text-sm flex items-center justify-center gap-3 animate-pulse">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" /></svg>
                    <span class="text-left">Para instalar la app, toca <strong>Compartir</strong> y luego <strong>"Agregar a la pantalla de inicio"</strong>.</span>
                </div>
            </div>
        </div>

        <div class="mt-8 text-center">
             <a href="https://www.kebuenaqro.mx" target="_blank" rel="noopener noreferrer" class="text-orange-300 hover:text-orange-100 hover:underline transition-colors text-lg">
                www.kebuenaqro.mx
             </a>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, Timestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // --- LÓGICA DE LA APLICACIÓN ---

        const manifest = {
            "name": "Kebuenaqro", "short_name": "Kebuenaqro", "start_url": ".", "display": "standalone",
            "background_color": "#1e293b", "theme_color": "#c2410c", "description": "Reproductor de Kebuenaqro.",
            "icons": [{"src": "https://fantasma-beep.github.io/kebuenaqro/logotipo2.png?v=3", "type": "image/png", "sizes": "192x192"}, {"src": "https://fantasma-beep.github.io/kebuenaqro/logotipo2.png?v=3", "type": "image/png", "sizes": "512x512"}]
        };
        const manifestBlob = new Blob([JSON.stringify(manifest)], { type: 'application/json' });
        document.getElementById('manifest-link').setAttribute('href', URL.createObjectURL(manifestBlob));
        
        const installBtn = document.getElementById('install-btn');
        const iosInstallBanner = document.getElementById('ios-install-banner');
        let deferredPrompt;
        
        const isIOS = () => /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        const isAppInstalled = () => window.matchMedia('(display-mode: standalone)').matches;

        // --- Lógica para el contador de instalaciones con Firebase ---
        let db;
        try {
            const firebaseConfig = {
                // ESTA ES UNA CONFIGURACIÓN DE EJEMPLO - NO FUNCIONARÁ
                apiKey: "AIza...",
                authDomain: "...",
                projectId: "...",
            };
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
        } catch (e) {
            console.warn("Firebase no está configurado. El contador de instalaciones no funcionará.");
        }

        window.addEventListener('appinstalled', async (e) => {
            console.log('PWA fue instalada.');
            installBtn.classList.add('hidden');
            if(db) {
                try {
                    const analyticsCollection = collection(db, 'installs');
                    await addDoc(analyticsCollection, {
                        installedAt: Timestamp.now(),
                        userAgent: navigator.userAgent
                    });
                    console.log("Instalación registrada en Firebase.");
                } catch (error) {
                    console.error("Error al registrar la instalación:", error);
                }
            }
        });


        window.addEventListener('beforeinstallprompt', (e) => {
          if (isAppInstalled()) return;
          e.preventDefault();
          deferredPrompt = e;
          installBtn.classList.remove('hidden');
        });

        installBtn.addEventListener('click', async () => {
          if (deferredPrompt) {
            deferredPrompt.prompt();
          }
        });

        if (isIOS() && !isAppInstalled()) {
            iosInstallBanner.classList.remove('hidden');
        }

        function populateBanners() {
            const bannerImages = [
                'banner1.jpeg', 'banner2.jpeg', 'banner3.jpeg', 'banner4.jpeg', 'banner5.jpeg'
            ];
            const baseUrl = 'https://fantasma-beep.github.io/kebuenaqro/';
            const bannerList = document.getElementById('banner-list');
            if (!bannerList) return;

            let bannerHTML = '';
            bannerImages.forEach(imgFile => {
                const imgUrl = `${baseUrl}${imgFile}`;
                bannerHTML += `<div class="w-full flex-shrink-0 bg-black flex justify-center items-center h-48"><img src="${imgUrl}" alt="Banner" class="w-auto h-full object-contain"></div>`;
            });

            bannerList.innerHTML = bannerHTML;
            
            let currentBanner = 0;
            const totalBanners = bannerImages.length;

            if (totalBanners > 1) {
                setInterval(() => {
                    currentBanner = (currentBanner + 1) % totalBanners;
                    bannerList.style.transform = `translateX(-${currentBanner * 100}%)`;
                }, 5000);
            }
        }

        const players = [];

        function initializePlayer(config) {
            const player = document.getElementById(config.playerId);
            const playPauseBtn = document.getElementById(config.playPauseBtnId);
            const playIcon = document.getElementById(config.playIconId);
            const pauseIcon = document.getElementById(config.pauseIconId);
            const volumeControl = document.getElementById(config.volumeControlId);
            const videoOverlay = document.getElementById(config.videoOverlayId);
            const loadingText = document.getElementById(config.loadingTextId);
            const playerLogo = document.getElementById(config.playerLogoId);
            const currentTimeEl = document.getElementById(config.currentTimeId);
            const totalTimeEl = document.getElementById(config.totalTimeId);

            let elapsedTimeInterval = null;
            let secondsElapsed = 0;
            
            players.push(player);

            function formatTime(totalSeconds) {
                const hours = Math.floor(totalSeconds / 3600);
                const minutes = Math.floor((totalSeconds % 3600) / 60);
                const seconds = totalSeconds % 60;
                return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`.replace(/^00:/, '');
            }

            function updateClock() {
                if (totalTimeEl) {
                    const now = new Date();
                    totalTimeEl.textContent = `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;
                }
            }
            setInterval(updateClock, 1000);
            updateClock();

            function setPlayState(isPlaying) {
                playIcon.classList.toggle('hidden', isPlaying);
                pauseIcon.classList.toggle('hidden', !isPlaying);
            }

            function loadStream() {
                loadingText.textContent = "Conectando...";
                videoOverlay.classList.remove('opacity-0');
                player.src = "";
                player.src = config.streamUrl;
                player.load();
                player.play().catch(e => console.error(`Error al iniciar stream para ${config.playerId}:`, e));
            }

            playPauseBtn.addEventListener('click', () => {
                if (player.paused) {
                    loadStream();
                } else {
                    player.pause();
                }
            });

            player.addEventListener('play', () => {
                players.forEach(p => {
                    if (p !== player && !p.paused) {
                        p.pause();
                    }
                });
                videoOverlay.classList.add('opacity-0');
                setPlayState(true);
                playerLogo.classList.add('logo-playing');
                secondsElapsed = 0;
                currentTimeEl.textContent = '00:00';
                if (elapsedTimeInterval) clearInterval(elapsedTimeInterval);
                elapsedTimeInterval = setInterval(() => {
                    secondsElapsed++;
                    currentTimeEl.textContent = formatTime(secondsElapsed);
                }, 1000);
            });

            player.addEventListener('pause', () => {
                setPlayState(false);
                playerLogo.classList.remove('logo-playing');
                if (elapsedTimeInterval) clearInterval(elapsedTimeInterval);
            });
            
            player.addEventListener('error', (e) => {
                console.error(`Error de audio para ${config.playerId}:`, player.error);
                loadingText.innerHTML = `<span class="text-red-400">Error en ${config.stationName}</span>`;
                videoOverlay.classList.remove('opacity-0');
                setPlayState(false);
                playerLogo.classList.remove('logo-playing');
                if (elapsedTimeInterval) clearInterval(elapsedTimeInterval);
                currentTimeEl.textContent = '--:--';
            });
            
            volumeControl.addEventListener('input', (e) => { player.volume = e.target.value / 100; });
            loadingText.textContent = "Haz clic para escuchar";
        }
        
        function populateNews() {
            const newsList = document.getElementById('news-list');
            if (!newsList) return;

            const newsData = [
                { title: "Presentan programa oficial de la Feria de Cadereyta 2025.", link: "#", thumbnail: "https://placehold.co/80x80/c2410c/FFFFFF?text=Feria" },
                { title: "Anuncian cierre de vialidades en el centro de Jalpan por obras.", link: "#", thumbnail: "https://placehold.co/80x80/c2410c/FFFFFF?text=Obras" },
                { title: "Querétaro se posiciona como líder en inversión aeroespacial.", link: "#", thumbnail: "https://placehold.co/80x80/c2410c/FFFFFF?text=Qro" },
                { title: "Invitan a la ruta del queso y el vino en Cadereyta este fin de semana.", link: "#", thumbnail: "https://placehold.co/80x80/c2410c/FFFFFF?text=Ruta" },
                { title: "Jalpan de Serra Pueblo Mágico, rompe récord de visitantes.", link: "#", thumbnail: "https://placehold.co/80x80/c2410c/FFFFFF?text=Turismo" },
                { title: "Abren nueva convocatoria para becas universitarias en Querétaro.", link: "#", thumbnail: "https://placehold.co/80x80/c2410c/FFFFFF?text=Becas" }
            ];
            
            let newsHTML = '';
            newsData.forEach(news => {
                newsHTML += `
                    <a href="${news.link}" target="_blank" rel="noopener noreferrer" class="inline-flex items-center flex-shrink-0 px-6 py-3 hover:bg-orange-800 transition-colors rounded-lg">
                        <img src="${news.thumbnail}" alt="Miniatura" class="h-10 w-10 object-cover rounded-md mr-4 flex-shrink-0">
                        <span class="text-sm text-orange-200 whitespace-normal">${news.title}</span>
                    </a>
                `;
            });
            
            newsList.innerHTML = newsHTML + newsHTML;
            newsList.classList.add('animate-scroll');
        }


        window.addEventListener('DOMContentLoaded', () => {
            initializePlayer({
                stationName: 'Kebuena Cadereyta',
                playerId: 'player-1', playPauseBtnId: 'play-pause-btn-1', playIconId: 'play-icon-1', pauseIconId: 'pause-icon-1',
                volumeControlId: 'volume-control-1', videoOverlayId: 'video-overlay-1', loadingTextId: 'loading-text-1',
                playerLogoId: 'player-logo-1', currentTimeId: 'current-time-1', totalTimeId: 'total-time-1',
                streamUrl: "https://laradiossl.online:10567/;"
            });
            
            initializePlayer({
                stationName: 'Kebuena Jalpan',
                playerId: 'player-2', playPauseBtnId: 'play-pause-btn-2', playIconId: 'play-icon-2', pauseIconId: 'pause-icon-2',
                volumeControlId: 'volume-control-2', videoOverlayId: 'video-overlay-2', loadingTextId: 'loading-text-2',
                playerLogoId: 'player-logo-2', currentTimeId: 'current-time-2', totalTimeId: 'total-time-2',
                // CAMBIO: Se agrega un ";" al final de la URL, que es un formato común.
                streamUrl: "https://laradiossl.online:10485/;"
            });

            populateNews();
            populateBanners();
        });
    </script>
</body>
</html>

