<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kebuenaqro</title>
<meta name="theme-color" content="#c2410c"/>
<meta name="description" content="Reproductor de streaming de Kebuenaqro.">

<script src="https://cdn.tailwindcss.com"></script>
<link rel="manifest" href="manifest.json?v=2">
<link rel="apple-touch-icon" href="https://fantasma-beep.github.io/kebuenaqro/logo-ke-buena-web.png?v=6">

<style>
body {
    background-image: linear-gradient(rgba(15,23,42,0.85), rgba(15,23,42,0.98)), url('https://fantasma-beep.github.io/kebuenaqro/494615713_1348055410294820_9029691649736311255_n.jpg');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
}
input[type=range]{-webkit-appearance:none;appearance:none;background:transparent;cursor:pointer;width:100%}
input[type=range]:focus{outline:none}
input[type=range]::-webkit-slider-runnable-track{background-color:#9a3412;border-radius:.5rem;height:.5rem}
input[type=range]::-moz-range-track{background-color:#9a3412;border-radius:.5rem;height:.5rem}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;margin-top:-6px;background-color:#fdba74;border-radius:50%;height:1.25rem;width:1.25rem;border:2px solid #c2410c}
input[type=range]::-moz-range-thumb{border:none;border-radius:50%;background-color:#fdba74;height:1.25rem;width:1.25rem;border:2px solid #c2410c}
@keyframes scroll {from {transform: translateX(0);} to {transform: translateX(-50%);}}
.animate-scroll {animation: scroll 60s linear infinite;}
#splash-screen {transition: opacity 0.5s ease-out;}
#banner-list img {width:100%; height:100%; object-fit:contain;}
</style>
</head>
<body class="bg-slate-900 text-slate-200 flex items-center justify-center min-h-screen font-sans antialiased p-4">

<!-- SPLASH SCREEN -->
<div id="splash-screen" class="fixed inset-0 bg-slate-900 flex flex-col justify-center items-center z-50">
    <img src="https://fantasma-beep.github.io/kebuenaqro/logo-ke-buena-web.png?v=6" alt="Logo Kebuena" class="w-64">
    <p class="text-2xl font-bold text-white mt-4">Kebuena Querétaro</p>
</div>

<!-- MAIN CONTENT -->
<div id="main-content" class="w-full max-w-5xl mx-auto opacity-0 transition-opacity duration-500">

    <!-- BANNERS -->
    <div class="mb-8 w-full overflow-hidden rounded-lg border border-orange-700/50 bg-black/20">
        <div id="banner-list" class="flex transition-transform duration-700 ease-in-out">
            <!-- banners se insertan dinámicamente -->
        </div>
    </div>

    <!-- REPRODUCTORES -->
    <div class="flex flex-col md:flex-row justify-center gap-8">
        <!-- Aquí copia y pega tu HTML completo de reproductores 1 y 2 -->
        <!-- Incluye player, botones, rango de volumen, info de track, etc. -->
    </div>

    <!-- NEWS -->
    <div class="mt-8">
        <div class="bg-orange-800/80 backdrop-blur-sm rounded-lg shadow-lg overflow-hidden border border-orange-700">
            <div id="news-ticker-container" class="whitespace-nowrap">
                <div id="news-list" class="inline-block">
                    <!-- noticias se insertan dinámicamente -->
                </div>
            </div>
        </div>
    </div>

    <!-- INSTALACIÓN PWA -->
    <div class="mt-6 text-center">
        <button id="install-btn" class="hidden bg-orange-600 hover:bg-orange-500 text-white font-bold py-2 px-4 rounded-lg inline-flex items-center transition">
            <span>Instalar Aplicación</span>
        </button>
        <div id="ios-install-banner" class="hidden bg-orange-800/80 p-3 rounded-lg text-white text-sm flex items-center justify-center gap-3 animate-pulse">
            <span>Para instalar la app, toca <strong>Compartir</strong> y luego <strong>"Agregar a la pantalla de inicio"</strong>.</span>
        </div>
    </div>

    <div class="mt-8 text-center">
        <a href="https://www.kebuenaqro.mx" target="_blank" rel="noopener noreferrer" class="text-orange-300 hover:text-orange-100 hover:underline transition-colors text-lg">
            www.kebuenaqro.mx
        </a>
    </div>

</div>

<script>
/* --- SERVICE WORKER --- */
if ('serviceWorker' in navigator && (location.protocol === 'http:' || location.protocol === 'https:')) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
            .then(reg => console.log('SW registrado con éxito:', reg.scope))
            .catch(err => console.error('Error al registrar SW:', err));
    });
}

/* --- PWA INSTALL --- */
const installBtn = document.getElementById('install-btn');
const iosInstallBanner = document.getElementById('ios-install-banner');
let deferredPrompt;
const isIOS = () => /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
const isAppInstalled = () => window.matchMedia('(display-mode: standalone)').matches;

window.addEventListener('appinstalled', () => installBtn?.classList.add('hidden'));
window.addEventListener('beforeinstallprompt', (e) => {
    if (isAppInstalled()) return;
    e.preventDefault();
    deferredPrompt = e;
    installBtn?.classList.remove('hidden');
});

installBtn?.addEventListener('click', async () => { deferredPrompt?.prompt(); });
if (isIOS() && !isAppInstalled()) iosInstallBanner?.classList.remove('hidden');

/* --- SPLASH SCREEN & INIT --- */
window.addEventListener('DOMContentLoaded', () => {
    const splash = document.getElementById('splash-screen');
    const main = document.getElementById('main-content');
    setTimeout(() => {
        splash?.classList.add('opacity-0');
        setTimeout(() => splash?.classList.add('hidden'), 500);
        main?.classList.remove('opacity-0');
    }, 2000);

    // --- Inicialización completa ---
    populateBanners();
    populateNews();

    initializePlayer({
        stationName: 'Kebuena Cadereyta',
        playerId: 'player-1',
        playPauseBtnId: 'play-pause-btn-1',
        playIconId: 'play-icon-1',
        pauseIconId: 'pause-icon-1',
        volumeControlId: 'volume-control-1',
        videoOverlayId: 'video-overlay-1',
        loadingTextId: 'loading-text-1',
        playerLogoId: 'player-logo-1',
        currentTimeId: 'current-time-1',
        totalTimeId: 'total-time-1',
        streamUrl: "https://laradiossl.online:10567/;"
    });

    initializePlayer({
        stationName: 'Kebuena Jalpan',
        playerId: 'player-2',
        playPauseBtnId: 'play-pause-btn-2',
        playIconId: 'play-icon-2',
        pauseIconId: 'pause-icon-2',
        volumeControlId: 'volume-control-2',
        videoOverlayId: 'video-overlay-2',
        loadingTextId: 'loading-text-2',
        playerLogoId: 'player-logo-2',
        currentTimeId: 'current-time-2',
        totalTimeId: 'total-time-2',
        streamUrl: "https://laradiossl.online:10485/;"
    });
});
</script>
</body>
</html>
